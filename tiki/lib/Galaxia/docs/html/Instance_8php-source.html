<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Instance.php Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>Instance.php</h1><div class="fragment"><pre>00001 &lt;?php
00004 
00007 <span class="keyword">class </span>Instance <span class="keyword">extends</span> Base {
00008   var $properties = Array();
00009   var $user = '';
00010   var $status = '';
00011   var $activities = Array();
00012   var $process;
00013   var $instanceId = 0;
00014   
00019   function getInstance($instanceId)
00020   {
00021     <span class="comment">// Get the instance data</span>
00022     $query = <span class="stringliteral">"select * from galaxia_instances where instanceId=$instanceId"</span>;
00023     $result = $this-&gt;query($query);
00024     <span class="keywordflow">if</span>(!$result-&gt;numRows()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00025     $res = $result-&gt;fetchRow(DB_FETCHMODE_ASSOC);
00026 
00027         <span class="comment">//Populate </span>
00028         $this-&gt;properties = unserialize($res['properties']);
00029         $this-&gt;user = $res['user'];
00030         $this-&gt;status = $res['status'];
00031         $this-&gt;process = $res['process'];
00032         $this-&gt;instanceId = $res['instanceId'];
00033     
00034     <span class="comment">// Get the activities where the instance is</span>
00035     
00036   }
00037   
00039   function set($name,$value)
00040   {
00041     $this-&gt;properties[$name] = $value;
00042     <span class="comment">//Save to the database</span>
00043   }
00044   
00046   function get($name)
00047   {
00048     <span class="keywordflow">if</span>(isset($this-&gt;properties[$name])) {
00049       <span class="keywordflow">return</span> $this-&gt;properties[$name];
00050     } <span class="keywordflow">else</span> {
00051       <span class="keywordflow">return</span> <span class="keyword">false</span>;
00052     }
00053   }
00054   
00056   function getActivities()
00057   {
00058     <span class="keywordflow">return</span> $this-&gt;activities;
00059   }
00060   
00062   function getStatus()
00063   {
00064     <span class="keywordflow">return</span> $this-&gt;status;
00065   }
00066   
00068   function setStatus($status)
00069   {
00070     $this-&gt;status = $status; 
00071     <span class="comment">// and update the database</span>
00072   }
00073   
00075   function getProcess()
00076   {
00077         <span class="keywordflow">return</span> $this-&gt;process;
00078   }
00079   
00081   function getUser()
00082   {
00083     <span class="keywordflow">return</span> $this-&gt;user;
00084   }
00085   
00087   function setUser($user)
00088   {
00089     $this-&gt;user = $user;
00090     <span class="comment">// save database</span>
00091   }
00092   
00093   
00099   function complete($activityId)
00100   {
00101   
00102   }
00103   
00108   function terminate()
00109   {
00110   
00111   }
00112   
00113   function sendTo($activities)
00114   {
00115     <span class="comment">//1: if we are in a join check</span>
00116     <span class="comment">//if this instance is also in</span>
00117     <span class="comment">//other activities if so do</span>
00118     <span class="comment">//nothing</span>
00119         
00120     <span class="comment">//1: if activity is not start then</span>
00121     <span class="comment">//check if there a transition from</span>
00122     <span class="comment">//one of the instance activities to</span>
00123     <span class="comment">//the destination (or all the</span>
00124     <span class="comment">//destinations if we are splitting</span>
00125     
00126     <span class="comment">//update the instance_activities table</span>
00127     
00128     <span class="comment">//we are now in a new activity</span>
00129     
00130     <span class="comment">//get roles and maps and determine user</span>
00131     <span class="comment">//or user is *, use keepUser to check</span>
00132     <span class="comment">//if we have to mantain the user or not</span>
00133     <span class="comment">//foreach activity update the user</span>
00134     
00135     <span class="comment">//set the user for the instance</span>
00136     
00137         <span class="comment">//if the activity is not interactive then</span>
00138         <span class="comment">//execute the code for the activity and</span>
00139         <span class="comment">//mark the activity as completed adding</span>
00140         <span class="comment">//a workitem</span>
00141         
00142                 <span class="comment">//if this activity is autorouted then</span>
00143                 <span class="comment">//determine the next activities or</span>
00144                 <span class="comment">//activities (if splitting) and</span>
00145                 <span class="comment">//send the instance there</span>
00146     
00147   }
00148   
00149   
00150 }
00151 ?&gt;
</pre></div><hr><address style="align: right;"><small>Generated on Mon Apr 14 11:51:59 2003 for Galaxia by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc3 </small></address>
</body>
</html>
