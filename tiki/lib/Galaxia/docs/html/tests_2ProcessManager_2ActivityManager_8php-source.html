<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ActivityManager.php Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>ActivityManager.php</h1><div class="fragment"><pre>00001 &lt;?
00002 
00003 <span class="keyword">class </span>ActivityManagerTest <span class="keyword">extends</span> PHPUnit_TestCase {
00004     <span class="comment">// contains the object handle of the string class</span>
00005     var $activityManager;
00006     
00007     <span class="comment">// constructor of the test suite</span>
00008     function ParseDataTest($name) {
00009        $this-&gt;PHPUnit_TestCase($name);
00010     }
00011     <span class="comment">// called before the test functions will be executed    </span>
00012     <span class="comment">// this function is defined in PHPUnit_TestCase and overwritten </span>
00013     <span class="comment">// here</span>
00014     function setUp() {
00015                 global $dbTiki;
00016                 $this-&gt;activityManager=<span class="keyword">new</span> <a class="code" href="classActivityManager.html">ActivityManager</a>($dbTiki);     
00017     }
00018     
00019     <span class="comment">// called after the test functions are executed    </span>
00020     <span class="comment">// this function is defined in PHPUnit_TestCase and overwritten </span>
00021     <span class="comment">// here    </span>
00022     function tearDown() {
00023         <span class="comment">// delete your instance</span>
00024         unset($this-&gt;activityManager);
00025     }
00026   
00027     function testAddRemoveListactivities() {
00028         $pId = 1;
00029         $this-&gt;foo='bar';
00030         $vars = Array(  'name' =&gt; 'fooactivity',
00031                         'description' =&gt; '<span class="keyword">this</span> is fooactivity',
00032                         'type' =&gt; 'start',
00033                         'isAutoRouted' =&gt; <span class="charliteral">'y'</span>,
00034                         'isInteractive' =&gt; <span class="charliteral">'n'</span>
00035                      );
00036         $activities = $this-&gt;activityManager-&gt;list_activities($pId,0,-1,'activityId_desc<span class="charliteral">','</span>');
00037         $cant = $activities['cant'];             
00038                 $aid = $this-&gt;activityManager-&gt;replace_activity($pId,0,$vars);        
00039             $this-&gt;rid = $aid;
00040                 $activities = $this-&gt;activityManager-&gt;list_activities($pId,0,-1,'activityId_desc<span class="charliteral">','</span>');
00041                 $this-&gt;assertEquals($activities['cant'],$cant+1);                       
00042                 $this-&gt;activityManager-&gt;remove_activity($pId,$aid);     
00043                 $activities = $this-&gt;activityManager-&gt;list_activities($pId,0,-1,'activityId_desc<span class="charliteral">','</span>');  
00044                 $this-&gt;assertEquals($activities['cant'],$cant);                       
00045     }
00046     
00047     function testGetactivity() {
00048         $pId = 1;
00049         $this-&gt;foo='bar';
00050         $vars = Array(  'name' =&gt; 'fooactivity',
00051                         'description' =&gt; '<span class="keyword">this</span> is fooactivity',
00052                         'type' =&gt; 'start',
00053                         'isAutoRouted' =&gt; <span class="charliteral">'y'</span>,
00054                         'isInteractive' =&gt; <span class="charliteral">'n'</span>
00055                      );
00056                 $aid = $this-&gt;activityManager-&gt;replace_activity($pId,0,$vars);        
00057                 $activity = $this-&gt;activityManager-&gt;get_activity($pId,$aid);
00058                 $this-&gt;assertEquals($activity['name'],'fooactivity');                       
00059                 $this-&gt;assertEquals($activity['description'],'<span class="keyword">this</span> is fooactivity');                       
00060                 $this-&gt;activityManager-&gt;remove_activity($pId,$aid);     
00061     }
00062     
00063     function testList() {
00064         $vars = Array(  'name' =&gt; 'fooactivity',
00065                         'description' =&gt; '<span class="keyword">this</span> is fooactivity',
00066                         'type' =&gt; 'start',
00067                         'isAutoRouted' =&gt; <span class="charliteral">'y'</span>,
00068                         'isInteractive' =&gt; <span class="charliteral">'n'</span>
00069                      );
00070         $procs = $this-&gt;activityManager-&gt;list_activities(1,0,-1,'activityId_desc<span class="charliteral">','</span>');
00071         $procs = $this-&gt;activityManager-&gt;list_activities(1,0,-1,'activityId_desc<span class="charliteral">','</span>',<span class="stringliteral">"name='foo activity'"</span>);
00072         $procs = $this-&gt;activityManager-&gt;list_activities(1,0,-1,'activityId_desc<span class="charliteral">','</span>foo');
00073         $procs = $this-&gt;activityManager-&gt;list_activities(1,0,-1,'name_desc<span class="charliteral">','</span>');
00074                 $aid = $this-&gt;activityManager-&gt;replace_activity(1,0,$vars);        
00075         $procs = $this-&gt;activityManager-&gt;list_activities(1,0,-1,'activityId_desc<span class="charliteral">','</span>');
00076         $procs = $this-&gt;activityManager-&gt;list_activities(1,0,-1,'activityId_desc<span class="charliteral">','</span>',<span class="stringliteral">"name='foo activity'"</span>);
00077         $procs = $this-&gt;activityManager-&gt;list_activities(1,0,-1,'activityId_desc<span class="charliteral">','</span>foo');
00078         $procs = $this-&gt;activityManager-&gt;list_activities(1,0,-1,'name_desc<span class="charliteral">','</span>');
00079                 $this-&gt;activityManager-&gt;remove_activity(1,$aid);        
00080     }
00081 
00082     
00083     function testAddUpdateGetactivities() {
00084         $pId = 1;
00085         $this-&gt;foo='bar';
00086         $vars = Array(  'name' =&gt; 'fooactivity',
00087                         'description' =&gt; '<span class="keyword">this</span> is fooactivity',
00088                         'type' =&gt; 'start',
00089                         'isAutoRouted' =&gt; <span class="charliteral">'y'</span>,
00090                         'isInteractive' =&gt; <span class="charliteral">'n'</span>
00091                      );
00092                 $aid = $this-&gt;activityManager-&gt;replace_activity($pId,0,$vars);        
00093             $activities = $this-&gt;activityManager-&gt;list_activities($pId,0,-1,'activityId_desc<span class="charliteral">','</span>');
00094         $cant1 = $activities['cant'];             
00095         $vars = Array(  'name' =&gt; 'fooactivity2',
00096                         'description' =&gt; '<span class="keyword">this</span> is fooactivity2',
00097                         'type' =&gt; 'start',
00098                         'isAutoRouted' =&gt; <span class="charliteral">'y'</span>,
00099                         'isInteractive' =&gt; <span class="charliteral">'n'</span>
00100                      );
00101                 $aid = $this-&gt;activityManager-&gt;replace_activity($pId,$aid,$vars);                       
00102                 $activities = $this-&gt;activityManager-&gt;list_activities($pId,0,-1,'activityId_desc<span class="charliteral">','</span>');
00103                 $this-&gt;assertEquals($cant1,$activities['cant']);                        
00104                 $activity = $this-&gt;activityManager-&gt;get_activity($pId,$aid);
00105                 $this-&gt;assertEquals($activity['name'],'fooactivity2');                       
00106                 $this-&gt;assertEquals($activity['description'],'<span class="keyword">this</span> is fooactivity2');                       
00107                 $this-&gt;activityManager-&gt;remove_activity($pId,$aid);             
00108                 
00109     }
00110     
00111 
00112     function testAddRemoveActivities() {
00113         $pid = 938712371;
00114                 $vars = Array(  'name' =&gt; 'fooactivity<span class="charliteral">','</span>type' =&gt; 'activity');
00115                 $a1 = $this-&gt;activityManager-&gt;replace_activity($pid,0,$vars);                   
00116                 $vars = Array(  'name' =&gt; 'fooactivity2<span class="charliteral">','</span>type' =&gt; 'activity');
00117                 $a2 = $this-&gt;activityManager-&gt;replace_activity($pid,0,$vars);                   
00118                 $vars = Array(  'name' =&gt; 'fooactivity3<span class="charliteral">','</span>type' =&gt; 'activity');
00119                 $a3 = $this-&gt;activityManager-&gt;replace_activity($pid,0,$vars);                   
00120                 $this-&gt;activityManager-&gt;add_transition($pid,$a1,$a2);
00121                 $this-&gt;activityManager-&gt;add_transition($pid,$a2,$a3);
00122                 $this-&gt;activityManager-&gt;add_transition($pid,$a3,$a1);
00123             $ptrans = $this-&gt;activityManager-&gt;get_process_transitions($pid);            
00124             $this-&gt;assertEquals(count($ptrans),3);
00125                 $this-&gt;activityManager-&gt;remove_transition($a1,$a2);                     
00126                 $ptrans = $this-&gt;activityManager-&gt;get_process_transitions($pid);                
00127             $this-&gt;assertEquals(count($ptrans),2);
00128                 $this-&gt;activityManager-&gt;add_transition($pid,$a1,$a2);   
00129                 $this-&gt;activityManager-&gt;remove_activity($pid,$a1);
00130                 $ptrans = $this-&gt;activityManager-&gt;get_process_transitions($pid);                
00131             $this-&gt;assertEquals(count($ptrans),1);
00132             $this-&gt;activityManager-&gt;remove_transition($a2,$a3);                 
00133             $ptrans = $this-&gt;activityManager-&gt;get_process_transitions($pid);            
00134             $this-&gt;assertEquals(count($ptrans),0);
00135             $this-&gt;activityManager-&gt;remove_activity($pid,$a2);
00136             $this-&gt;activityManager-&gt;remove_activity($pid,$a3);
00137     }
00138     
00139         
00140         function testProcessValidation() {
00141         $pid = 938712373;
00142                 $vars = Array(  'name' =&gt; 'fooactivity<span class="charliteral">','</span>type' =&gt; 'start');
00143                 $a1 = $this-&gt;activityManager-&gt;replace_activity($pid,0,$vars);                   
00144                 $vars = Array(  'name' =&gt; 'fooactivity2<span class="charliteral">','</span>type' =&gt; 'activity');
00145                 $a2 = $this-&gt;activityManager-&gt;replace_activity($pid,0,$vars);                   
00146                 $vars = Array(  'name' =&gt; 'fooactivity3<span class="charliteral">','</span>type' =&gt; 'activity');
00147                 $a3 = $this-&gt;activityManager-&gt;replace_activity($pid,0,$vars);                   
00148                 $vars = Array(  'name' =&gt; 'fooactivity4<span class="charliteral">','</span>type' =&gt; 'end');
00149                 $a4 = $this-&gt;activityManager-&gt;replace_activity($pid,0,$vars);                   
00150 
00151                 $this-&gt;activityManager-&gt;add_transition($pid,$a1,$a2);   
00152                 $this-&gt;activityManager-&gt;add_transition($pid,$a2,$a3);   
00153                 $this-&gt;activityManager-&gt;add_transition($pid,$a3,$a4);   
00154                 $this-&gt;assertTrue($this-&gt;activityManager-&gt;validate_process_activities($pid));
00155 
00156                 $this-&gt;activityManager-&gt;remove_transition($a2,$a3);
00157                 $this-&gt;assertFalse($this-&gt;activityManager-&gt;validate_process_activities($pid));
00158 
00159                 $this-&gt;activityManager-&gt;remove_activity($pid,$a1);
00160                 $this-&gt;assertFalse($this-&gt;activityManager-&gt;validate_process_activities($pid));
00161 
00162                 $this-&gt;activityManager-&gt;remove_activity($pid,$a2);
00163             $this-&gt;activityManager-&gt;remove_activity($pid,$a3);
00164                 $this-&gt;activityManager-&gt;remove_activity($pid,$a4);
00165                 $ptrans = $this-&gt;activityManager-&gt;get_process_transitions($pid);                
00166             $this-&gt;assertEquals(count($ptrans),0);
00167 
00168         }
00169         
00170 
00171 
00172         function testProcessValidation2() {
00173         $pid = 93871272;
00174                 $vars = Array(  'name' =&gt; 'fooactivity<span class="charliteral">','</span>type' =&gt; 'spl-x');
00175                 $a1 = $this-&gt;activityManager-&gt;replace_activity($pid,0,$vars);                   
00176                 $vars = Array(  'name' =&gt; 'fooactivity2<span class="charliteral">','</span>type' =&gt; 'activity');
00177                 $a2 = $this-&gt;activityManager-&gt;replace_activity($pid,0,$vars);                   
00178                 $vars = Array(  'name' =&gt; 'fooactivity3<span class="charliteral">','</span>type' =&gt; 'activity');
00179                 $a3 = $this-&gt;activityManager-&gt;replace_activity($pid,0,$vars);                   
00180                 $this-&gt;assertTrue($this-&gt;activityManager-&gt;add_transition($pid,$a1,$a2));   
00181                 $this-&gt;assertTrue($this-&gt;activityManager-&gt;add_transition($pid,$a1,$a3));   
00182                 $this-&gt;assertTrue($this-&gt;activityManager-&gt;add_transition($pid,$a2,$a3));   
00183                 $this-&gt;assertFalse($this-&gt;activityManager-&gt;add_transition($pid,$a2,$a1));   
00184 
00185                 $this-&gt;activityManager-&gt;remove_activity($pid,$a1);
00186                 $this-&gt;activityManager-&gt;remove_activity($pid,$a2);
00187             $this-&gt;activityManager-&gt;remove_activity($pid,$a3);
00188 
00189         }
00190 
00191         
00192         
00193   }
00194 
00195 include_once('lib/Galaxia/src/<a class="code" href="classProcessManager.html">ProcessManager</a>/<a class="code" href="classActivityManager.html">ActivityManager</a>.php');  
00196 $suite = <span class="keyword">new</span> PHPUnit_TestSuite(<span class="stringliteral">"activityManagerTest"</span>);
00197 $result = PHPUnit::run($suite);
00198 echo $result -&gt; toHTML();
00199 ?&gt;
</pre></div><hr><address style="align: right;"><small>Generated on Mon Apr 14 11:51:57 2003 for Galaxia by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc3 </small></address>
</body>
</html>
