<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>BaseActivity.php Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3-rc3 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>BaseActivity.php</h1><div class="fragment"><pre>00001 &lt;?php
00004 
<a name="l00010"></a><a class="code" href="classBaseActivity.html">00010</a> <span class="keyword">class </span><a class="code" href="classBaseActivity.html">BaseActivity</a> <span class="keyword">extends</span> Base {
00011   var $name;
00012   var $normalizedName;
00013   var $description;
00014   var $isInteractive;
00015   var $isAutoRouted;
00016   var $roles=Array();
00017   var $outbound=Array();
00018   var $inbound=Array();
00019   var $pId;
00020   var $activityId;
00021   
00022   function setDb($db)
00023   {
00024     $this-&gt;db=$db;
00025   }
00026   
00027   function Base($db)
00028   {
00029     $this-&gt;db=$db;
00030   }
00031   
00032   
<a name="l00037"></a><a class="code" href="classBaseActivity.html#a2">00037</a>   function <a class="code" href="classBaseActivity.html#a2">getActivity</a>($activityId) 
00038   {
00039     $query = <span class="stringliteral">"select * from galaxia_activities where activityId=$activityId"</span>;
00040     $result = $this-&gt;query($query);
00041     <span class="keywordflow">if</span>(!$result-&gt;numRows()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
00042     $res = $result-&gt;fetchRow(DB_FETCHMODE_ASSOC);
00043     <span class="keywordflow">switch</span>($res['type']) {
00044       <span class="keywordflow">case</span> 'start':
00045         $act = <span class="keyword">new</span> Start($this-&gt;db);  
00046       <span class="keywordflow">break</span>;
00047       <span class="keywordflow">case</span> 'end':
00048         $act = <span class="keyword">new</span> End($this-&gt;db);
00049       <span class="keywordflow">break</span>;
00050       <span class="keywordflow">case</span> 'join':
00051         $act = <span class="keyword">new</span> Join($this-&gt;db);
00052       <span class="keywordflow">break</span>;
00053       <span class="keywordflow">case</span> 'split':
00054         $act = <span class="keyword">new</span> Split($this-&gt;db);
00055       <span class="keywordflow">break</span>;
00056       <span class="keywordflow">case</span> 'standalone':
00057         $act = <span class="keyword">new</span> Standalone($this-&gt;db);
00058       <span class="keywordflow">break</span>;
00059       <span class="keywordflow">case</span> '<span class="keywordflow">switch</span>':
00060         $act = <span class="keyword">new</span> SwitchActivity($this-&gt;db);
00061       <span class="keywordflow">break</span>;
00062       <span class="keywordflow">case</span> 'activity':
00063         $act = <span class="keyword">new</span> Activity($this-&gt;db);
00064       <span class="keywordflow">break</span>;
00065       <span class="keywordflow">default</span>:
00066         trigger_error('Unknown activity type:'.$res['type'],E_USER_WARNING);
00067     }
00068     
00069     $act-&gt;setName($res['name']);
00070     $act-&gt;setProcessId($res['pId']);
00071     $act-&gt;setNormalizedName($res['normalized_name']);
00072     $act-&gt;setDescription($res['description']);
00073     $act-&gt;setIsInteractive($res['isInteractive']);
00074     $act-&gt;setIsAutoRouted($res['isAutoRouted']);
00075     $act-&gt;setActivityId($res['activityId']);
00076     
00077     <span class="comment">//Now get forward transitions </span>
00078     
00079     <span class="comment">//Now get backward transitions</span>
00080     
00081     <span class="comment">//Now get roles</span>
00082     $query = <span class="stringliteral">"select roleId from galaxia_activity_roles where activityId="</span>.$res['activityId'];
00083     $result=$this-&gt;query($query);
00084     <span class="keywordflow">while</span>($res = $result-&gt;fetchRow(DB_FETCHMODE_ASSOC)) {
00085       $this-&gt;roles[] = $res['roleId'];
00086     }
00087     $act-&gt;setRoles($this-&gt;roles);
00088     <span class="keywordflow">return</span> $act;
00089   }
00090   
<a name="l00092"></a><a class="code" href="classBaseActivity.html#a3">00092</a>   function <a class="code" href="classBaseActivity.html#a3">getUserRoles</a>($user)
00093   {
00094     $query = <span class="stringliteral">"select roleId from galaxia_user_roles where user='$user'"</span>;
00095     $result=$this-&gt;query($query);
00096     $ret = Array();
00097     <span class="keywordflow">while</span>($res = $result-&gt;fetchRow(DB_FETCHMODE_ASSOC)) {
00098       $ret[] = $res['roleId'];
00099     }
00100     <span class="keywordflow">return</span> $ret;
00101   }
00102 
<a name="l00105"></a><a class="code" href="classBaseActivity.html#a4">00105</a>   function <a class="code" href="classBaseActivity.html#a4">getActivityRoleNames</a>()
00106   {
00107     $aid = $this-&gt;activityId;
00108     $query = <span class="stringliteral">"select gr.roleId,name from galaxia_activity_roles gar, galaxia_roles gr where gar.roleId=gr.roleId and gar.activityId=$aid"</span>;
00109     $result=$this-&gt;query($query);
00110     $ret = Array();
00111     <span class="keywordflow">while</span>($res = $result-&gt;fetchRow(DB_FETCHMODE_ASSOC)) {
00112       $ret[] = $res;
00113     }
00114     <span class="keywordflow">return</span> $ret;
00115   }
00116   
<a name="l00118"></a><a class="code" href="classBaseActivity.html#a5">00118</a>   function <a class="code" href="classBaseActivity.html#a5">getNormalizedName</a>() 
00119   {
00120         <span class="keywordflow">return</span> $this-&gt;normalizedName;
00121   }
00122 
<a name="l00124"></a><a class="code" href="classBaseActivity.html#a6">00124</a>   function <a class="code" href="classBaseActivity.html#a6">setNormalizedName</a>($name)
00125   {
00126     $this-&gt;normalizedName=$name;
00127   }
00128   
<a name="l00130"></a><a class="code" href="classBaseActivity.html#a7">00130</a>   function <a class="code" href="classBaseActivity.html#a7">setName</a>($name)
00131   {
00132     $this-&gt;name=$name;
00133   }
00134   
<a name="l00136"></a><a class="code" href="classBaseActivity.html#a8">00136</a>   function <a class="code" href="classBaseActivity.html#a8">getName</a>()
00137   {
00138     <span class="keywordflow">return</span> $this-&gt;name;
00139   }
00140   
<a name="l00142"></a><a class="code" href="classBaseActivity.html#a9">00142</a>   function <a class="code" href="classBaseActivity.html#a9">setDescription</a>($desc)
00143   {
00144     $this-&gt;description=$desc;
00145   }
00146   
<a name="l00148"></a><a class="code" href="classBaseActivity.html#a10">00148</a>   function <a class="code" href="classBaseActivity.html#a10">getDescription</a>()
00149   {
00150     <span class="keywordflow">return</span> $this-&gt;description;
00151   }
00152   
<a name="l00154"></a><a class="code" href="classBaseActivity.html#a11">00154</a>   function <a class="code" href="classBaseActivity.html#a11">setIsInteractive</a>($is)
00155   {
00156     $this-&gt;isInteractive=$is;
00157   }
00158   
<a name="l00160"></a><a class="code" href="classBaseActivity.html#a12">00160</a>   function <a class="code" href="classBaseActivity.html#a12">isInteractive</a>()
00161   {
00162     <span class="keywordflow">return</span> $this-&gt;isInteractive;
00163   }
00164   
<a name="l00166"></a><a class="code" href="classBaseActivity.html#a13">00166</a>   function <a class="code" href="classBaseActivity.html#a13">setIsAutoRouted</a>($is)
00167   {
00168     $this-&gt;isAutoRouted = $is;
00169   }
00170   
<a name="l00172"></a><a class="code" href="classBaseActivity.html#a14">00172</a>   function <a class="code" href="classBaseActivity.html#a14">isAutoRouted</a>()
00173   {
00174     <span class="keywordflow">return</span> $this-&gt;isAutoRouted;
00175   }
00176 
<a name="l00178"></a><a class="code" href="classBaseActivity.html#a15">00178</a>   function <a class="code" href="classBaseActivity.html#a15">setProcessId</a>($pid)
00179   {
00180         $this-&gt;pId=$pid;
00181   }
00182   
<a name="l00184"></a><a class="code" href="classBaseActivity.html#a16">00184</a>   function <a class="code" href="classBaseActivity.html#a16">getProcessId</a>()
00185   {
00186     <span class="keywordflow">return</span> $this-&gt;pId;
00187   }
00188 
<a name="l00190"></a><a class="code" href="classBaseActivity.html#a17">00190</a>   function <a class="code" href="classBaseActivity.html#a17">getActivityId</a>()
00191   {
00192     <span class="keywordflow">return</span> $this-&gt;activityId;
00193   }  
00194   
<a name="l00196"></a><a class="code" href="classBaseActivity.html#a18">00196</a>   function <a class="code" href="classBaseActivity.html#a18">setActivityId</a>($id)
00197   {
00198     $this-&gt;activityId=$id;
00199   }
00200   
<a name="l00202"></a><a class="code" href="classBaseActivity.html#a19">00202</a>   function <a class="code" href="classBaseActivity.html#a19">getRoles</a>()
00203   {
00204     <span class="keywordflow">return</span> $this-&gt;roles;
00205   }
00206   
<a name="l00209"></a><a class="code" href="classBaseActivity.html#a20">00209</a>   function <a class="code" href="classBaseActivity.html#a20">setRoles</a>($roles)
00210   {
00211     $this-&gt;roles = $roles;
00212   }
00213   
00214 }
00215 ?&gt;
</pre></div><hr><address style="align: right;"><small>Generated on Mon Apr 21 11:15:31 2003 for Galaxia by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.3-rc3 </small></address>
</body>
</html>
