contributor:
$Author: mlinton $

revision:
1.3.5

lastmodif:
$Date: 2004-12-12 20:14:49 $

files: 
features/cc/cc.php cc.php
features/cc/lib/cclib.php lib/cc/cclib.php
features/cc/templates/currencies.tpl templates/cc/currencies.tpl 
features/cc/templates/currencies_form.tpl templates/cc/currencies_form.tpl
features/cc/templates/index.tpl templates/cc/index.tpl
features/cc/templates/ledgers.tpl templates/cc/ledgers.tpl
features/cc/templates/transactions.tpl templates/cc/transactions.tpl
features/cc/templates/transactions_form.tpl templates/cc/transactions_form.tpl

sql-install:
create table if not exists cc_cc ( seq int not null primary key auto_increment, id varchar(255) not null unique, cc_name varchar(255) not null, cc_description text, owner_id varchar(255), requires_approval char(1) not null, listed char(1) not null default 'n', index ( id ), index ( cc_name(6) ));
create table if not exists cc_ledger ( seq int not null primary key auto_increment, acct_id varchar(255) null, cc_id varchar(255) not null, balance int not null, tr_total int not null, tr_count int not null, last_tr_date int(11), approved char(1), index ( acct_id ), index ( cc_id ), index ( last_tr_date));
create table if not exists cc_transaction ( seq int not null primary key auto_increment, tr_date int(11) not null, acct_id varchar(255) not null, other_id varchar(255) not null, other_domain varchar(255) not null, cc_id varchar(255) not null, amount int not null, item varchar(255), type varchar(5), balance int not null, index (tr_date), index ( acct_id ));
INSERT IGNORE INTO tiki_preferences(name,value) VALUES ('feature_cc','n');
INSERT IGNORE INTO users_permissions (permName, permDesc, level, type) VALUES ('tiki_p_cc_use', 'Can use community currencies', 'registered', 'cc');
INSERT IGNORE INTO users_permissions (permName, permDesc, level, type) VALUES ('tiki_p_cc_create', 'Can create new community currencies', 'registered', 'cc');
INSERT IGNORE INTO users_permissions (permName, permDesc, level, type) VALUES ('tiki_p_cc_admin', 'Administrate the currencies system', 'admin', 'cc');
delete from tiki_menu_options where url like 'cc%';
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'s','Currencies','',1400,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','Create Currency','cc.php?page=currencies&new',1410,'','tiki_p_cc_create','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','Add Transaction','cc.php?page=transactions&new',1420,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','My Currencies','cc.php?page=currencies&my',1430,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','My Ledgers','cc.php?page=my_ledgers',1440,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','My Transactions','cc.php?page=transactions',1450,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','List Currencies','cc.php?page=currencies',1460,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','List Ledgers','cc.php?page=ledgers',1470,'','tiki_p_cc_admin','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','List Transactions','cc.php?page=transactions&all',1480,'','tiki_p_cc_admin','');

sql-upgrade:
: 1.3.1
delete from tiki_menu_options where url like 'cc%';
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'s','Currencies','',1400,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','Create Currency','cc.php?page=currencies&new',1410,'','tiki_p_cc_create','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','Add Transaction','cc.php?page=transactions&new',1420,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','My Currencies','cc.php?page=currencies&my',1430,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','My Ledgers','cc.php?page=my_ledgers',1440,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','My Transactions','cc.php?page=transactions',1450,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','List Currencies','cc.php?page=currencies',1460,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','List Ledgers','cc.php?page=ledgers',1470,'','tiki_p_cc_admin','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','List Transactions','cc.php?page=transactions&all',1480,'','tiki_p_cc_admin','');

sql-remove:
drop table if exists cc_cc;
drop table if exists cc_ledger;
drop table if exists cc_transaction;

author:
Michael Linton
Thomas Riemer
Les Squires
Mose

licence:
GNU/LGPL

devurl:
http://dev.openmoney.org/TikiCc

Description: 
Multi-currencies management system

Changelog:
1.3.5 layout changes, prevent self credit transaction
1.3.4 added possibility to register an unlisted currency
1.3.3 added help link and transaction from currencies list
1 initial package

