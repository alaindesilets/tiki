contributor:
$Author: mose $

revision:
1.2.8

lastmodif:
$Date: 2004-11-13 22:43:52 $

files: 
features/cc/cc.php cc.php
features/cc/lib/cclib.php lib/cc/cclib.php
features/cc/templates/currencies.tpl templates/cc/currencies.tpl 
features/cc/templates/currencies_form.tpl templates/cc/currencies_form.tpl
features/cc/templates/index.tpl templates/cc/index.tpl
features/cc/templates/ledgers.tpl templates/cc/ledgers.tpl
features/cc/templates/transactions.tpl templates/cc/transactions.tpl
features/cc/templates/transactions_form.tpl templates/cc/transactions_form.tpl

sql-install:
create table if not exists cc_cc ( seq int not null primary key auto_increment, id varchar(255) not null unique, cc_name varchar(255) not null, cc_description text, owner_id varchar(255), requires_approval char(1) not null, listed char(1) not null default 'n', index ( id ), index ( cc_name(6) ));
create table if not exists cc_ledger ( seq int not null primary key auto_increment, acct_id varchar(255) null, cc_id varchar(255) not null, balance int not null, tr_total int not null, tr_count int not null, last_tr_date int(11), approved char(1), index ( acct_id ), index ( cc_id ), index ( last_tr_date));
create table if not exists cc_transaction ( seq int not null primary key auto_increment, tr_date int(11) not null, acct_id varchar(255) not null, other_id varchar(255) not null, other_domain varchar(255) not null, cc_id varchar(255) not null, amount int not null, item varchar(255), type varchar(5), balance int not null, index (tr_date), index ( acct_id ));
INSERT IGNORE INTO tiki_preferences(name,value) VALUES ('feature_cc','n');
INSERT IGNORE INTO users_permissions (permName, permDesc, level, type) VALUES ('tiki_p_cc_use', 'Can use community currencies', 'registered', 'cc');
INSERT IGNORE INTO users_permissions (permName, permDesc, level, type) VALUES ('tiki_p_cc_create', 'Can create new community currencies', 'registered', 'cc');
INSERT IGNORE INTO users_permissions (permName, permDesc, level, type) VALUES ('tiki_p_cc_admin', 'Administrate the currencies system', 'admin', 'cc');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'s','Currencies','',1400,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','Create Currency','cc.php?page=newcc',1410,'','tiki_p_cc_create','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','Add Transaction','cc.php?page=tr_record',1420,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','My Currencies','cc.php?page=my_cc',1430,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','My Ledgers','cc.php?page=my_ledgers',1440,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','My Transactions','cc.php?page=my_tr',1450,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','List Currencies','cc.php?page=currencies',1460,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','List Ledgers','cc.php?page=ledgers',1470,'','tiki_p_cc_use','');
INSERT IGNORE INTO tiki_menu_options (menuId,type,name,url,position,section,perm,groupname) VALUES (42,'o','List Transactions','cc.php?page=transactions',1480,'','tiki_p_cc_use','');

sql-upgrade:
: 1.2.8
alter table cc_ledger add approved char(1);
: 1.2.6
update users_permissions set level='registered' where permName='tiki_p_cc_create';
alter table cc_cc add listed char(1) not null default 'n';
alter table cc_cc modify id varchar(255) not null unique;
alter table cc_cc modify cc_name varchar(255) not null;
alter table cc_cc modify owner_id varchar(255);
alter table cc_ledger modify acct_id varchar(255);
alter table cc_ledger modify cc_id varchar(255);
alter table cc_ledger modify last_tr_date int(11);
alter table cc_transaction modify tr_date int(11);
alter table cc_transaction modify acct_id varchar(255);
alter table cc_transaction modify other_id varchar(255);
alter table cc_transaction modify other_domain varchar(255);
alter table cc_transaction modify cc_id varchar(255);
: 1.2.3
update tiki_menu_options set url='cc.php?page=app' where menuId=42 and name='Status';
update tiki_menu_options set url='cc.php?page=tr_record' where menuId=42 and name='Transaction';
update tiki_menu_options set url='cc.php?page=registercc' where menuId=42 and name='Register for CC';
update tiki_menu_options set url='cc.php?page=newcc' where menuId=42 and name='Create new CC';
update tiki_menu_options set url='cc.php?page=admincc' where menuId=42 and name='Admin CC';
: 1.2.2
update tiki_menu_options set type='s' where menuId=42 and name='Currencies';
: 1.2
INSERT IGNORE INTO tiki_preferences(name,value) VALUES ('feature_cc','n');

sql-remove:
drop table if exists cc_cc;
drop table if exists cc_ledger;
drop table if exists cc_transaction;

author:
openmoney.org

licence:
GNU/LGPL

Description: 
Multi-currencies management system

Changelog:
1 initial package
